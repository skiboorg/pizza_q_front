(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[14],{"980d":function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("q-page",{attrs:{padding:""}},[s("div",{staticClass:"container-sm"},[s("p",{staticClass:"text-bold text-h5"},[e._v("Ваш ID: "+e._s(e.$user.user.id))]),s("p",{staticClass:"text-bold text-h5"},[e._v("Баллов начислено: "+e._s(e.$user.user.bonuses))]),s("q-tabs",{staticClass:"text-grey",attrs:{outlined:"","inline-label":"","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[s("q-tab",{attrs:{"no-caps":"",name:"person",icon:"person",label:"Личные даные"}}),s("q-tab",{attrs:{"no-caps":"",name:"location_on",icon:"location_on",label:"Адреса доставки"}})],1),s("q-separator"),s("q-tab-panels",{attrs:{animated:""},model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[s("q-tab-panel",{attrs:{name:"person"}},[s("p",{staticClass:"text-h6"},[e._v("Личные данные")]),s("q-form",{staticClass:"q-gutter-sm q-mb-lg"},[s("q-input",{attrs:{outlined:"",label:"ФИО"},model:{value:e.userData.fio,callback:function(t){e.$set(e.userData,"fio",t)},expression:"userData.fio"}}),s("q-input",{attrs:{readonly:"",outlined:"",label:"Телефон"},model:{value:e.userData.phone,callback:function(t){e.$set(e.userData,"phone",t)},expression:"userData.phone"}}),e.$user.user.tg_username?e._e():s("p",[e._v("Введите Ваш telegram username, чтобы получать оповещения о заказах и восстанавливать пароль через телеграм бота."),s("br"),e._v("\n              Инструкция по подключению появится после того, как Вы укажете telegram username и нажмете кнопку сохранить.")]),s("q-input",{attrs:{error:!e.$user.user.tg_username,outlined:"",label:"Ваш telegram username"},model:{value:e.userData.tg_username,callback:function(t){e.$set(e.userData,"tg_username",t)},expression:"userData.tg_username"}})],1),e.$user.user.tg_username&&!e.$user.user.tg_id?s("div",{staticClass:"q-mb-md"},[s("p",{staticClass:"text-bold text-negative"},[e._v("Нужно подключить телеграм бота, следуйте инструкции:")]),e._v("\n              1. Создайте диалог с "),s("span",{staticClass:"text-bold text-negative"},[s("a",{attrs:{target:"_blank",href:"https://t.me/meat_coal_bot"}},[e._v("@meat_coal_bot")])]),s("br"),e._v("\n              2. В созданном диалоге нажмите Start"),s("br"),e._v("\n              3. Если вы все сделали правильно, бот сообщит об этом."),s("br"),e._v("\n              4. Обновите эту страницу или перезайдите в аккаунт, если это сообщение пропало, то все сделано правильно."),s("br"),e._v("\n              5. Бот будет присылать оповещения о заказах.\n          ")]):e._e(),s("div",{staticClass:"flex justify-between"},[e.$user.user.is_staff?s("q-btn",{attrs:{padding:"md","no-caps":"",unelevated:"",color:"warning",label:"Админка"},on:{click:function(t){return e.$router.push("/orders")}}}):e._e(),s("q-btn",{staticClass:" ",attrs:{padding:"md","no-caps":"",unelevated:"",color:"positive",label:"Сохранить"},on:{click:e.userDataSave}}),s("q-btn",{staticClass:" ",attrs:{padding:"md","no-caps":"",unelevated:"",color:"primary",label:"Выйти"},on:{click:e.userLogout}})],1)],1),s("q-tab-panel",{attrs:{name:"location_on"}},[s("p",{staticClass:"text-h6 q-mb-none"},[e._v("Адреса доставки")]),s("q-list",e._l(e.$user.user.addresses,(function(t){return s("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],key:t.id,attrs:{clickable:""}},[s("q-item-section",[e._v(e._s(t.street)+" "+e._s(t.house))]),s("q-item-section",{attrs:{avatar:""}},[s("q-icon",{attrs:{color:"grey-6",name:"delete"},on:{click:function(s){return e.deleteAddress(t.id)}}})],1)],1)})),1),s("q-form",[s("p",{staticClass:"text-bold"},[e._v("Добавить новый адрес")]),s("div",{staticClass:"flex justify-between no-wrap"},[s("q-input",{staticClass:"full-width q-mr-sm",attrs:{outlined:"",outlined:"",label:"Улица *",rules:[function(e){return!!e||"Это обязательное поле"}]},model:{value:e.newAddress.street,callback:function(t){e.$set(e.newAddress,"street",t)},expression:"newAddress.street"}}),s("q-input",{attrs:{outlined:"",outlined:"",label:"Дом *",rules:[function(e){return!!e||"Это обязательное поле"}]},model:{value:e.newAddress.house,callback:function(t){e.$set(e.newAddress,"house",t)},expression:"newAddress.house"}})],1),s("div",{staticClass:"flex justify-between no-wrap q-mb-md"},[s("q-input",{staticClass:" q-mr-sm",attrs:{outlined:"",type:"number",outlined:"",label:"Кв "},model:{value:e.newAddress.flat,callback:function(t){e.$set(e.newAddress,"flat",t)},expression:"newAddress.flat"}}),s("q-input",{staticClass:" q-mr-sm",attrs:{outlined:"",type:"number",outlined:"",label:"Подъезд "},model:{value:e.newAddress.podezd,callback:function(t){e.$set(e.newAddress,"podezd",t)},expression:"newAddress.podezd"}}),s("q-input",{staticClass:" q-mr-sm",attrs:{outlined:"",type:"number",outlined:"",label:"Код двери "},model:{value:e.newAddress.code,callback:function(t){e.$set(e.newAddress,"code",t)},expression:"newAddress.code"}}),s("q-input",{attrs:{outlined:"",outlined:"",type:"number",label:"Этаж "},model:{value:e.newAddress.floor,callback:function(t){e.$set(e.newAddress,"floor",t)},expression:"newAddress.floor"}})],1),s("q-btn",{staticClass:"full-width",attrs:{"no-caps":"",unelevated:"",padding:"md",color:"primary",label:"Добавить"},on:{click:e.userAddressSave}})],1)],1),s("q-tab-panel",{attrs:{name:"password"}})],1)],1)])},r=[],n=s("ded3"),l=s.n(n),i=(s("e6cf"),s("5319"),s("2f62")),o={preFetch({store:e,redirect:t}){e.state.auth.loggedIn||t({path:"/"})},data(){return{tab:"person",userData:{fio:this.$user.user.fio,email:this.$user.user.email,birthday:this.$user.user.birthday,tg_username:this.$user.user.tg_username,phone:this.$user.user.phone},newAddress:{street:null,house:null,flat:null,podezd:null,code:null,floor:null}}},methods:l()(l()(l()({},Object(i["b"])("auth",["getUser"])),Object(i["b"])("auth",["logoutUser"])),{},{async userDataSave(){this.userData.tg_username=this.userData.tg_username.replace("@","");await this.$api.post("/api/user/update",{userData:this.userData});await this.getUser(!1)},async userAddressSave(){await this.$api.post("/api/user/add_address",this.newAddress),await this.getUser(!1)},async deleteAddress(e){await this.$api.delete(`/api/user/delete_address/${e}`),await this.getUser(!1)},userLogout(){this.logoutUser(),this.$router.push("/")}})},u=o,d=s("2877"),c=s("9989"),p=s("429b"),b=s("7460"),m=s("eb85"),f=s("adad"),v=s("823b"),h=s("0378"),_=s("27f9"),w=s("9c40"),g=s("1c1c"),q=s("66e5"),$=s("4074"),x=s("0016"),A=s("714f"),k=s("eebe"),y=s.n(k),C=Object(d["a"])(u,a,r,!1,null,null,null);t["default"]=C.exports;y()(C,"components",{QPage:c["a"],QTabs:p["a"],QTab:b["a"],QSeparator:m["a"],QTabPanels:f["a"],QTabPanel:v["a"],QForm:h["a"],QInput:_["a"],QBtn:w["a"],QList:g["a"],QItem:q["a"],QItemSection:$["a"],QIcon:x["a"]}),y()(C,"directives",{Ripple:A["a"]})}}]);